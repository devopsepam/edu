# Main virtualhost
# PHP FastCGI backend

server {
  listen 80;
  server_name _;
  root /var/www/www.example.com;
  access_log /var/log/nginx/www.example.com-access.log main;
  error_log /var/log/nginx/www.example.com-error.log;

  index 	index.php;

  location / {
  		root /var/www/www.example.com;
  		index 	index.php;
  }
    location ~ \.php$ {
    if (!-f $request_filename) { return 404; }
    		autoindex on;
   	    fastcgi_pass   unix:/var/run/php-fpm-www.sock;
		 	fastcgi_read_timeout 2m;
		 	fastcgi_send_timeout 2m;
    	    fastcgi_index index.php;
    	include /etc/nginx/fastcgi_params;
	   	fastcgi_param SCRIPT_FILENAME /var/www/www.example.com$fastcgi_script_name;
	    }
	location @indexphp {
  		if (-f $document_root/index.php) { rewrite .* /index.php last; }
		}
	try_files $uri @indexphp;
}